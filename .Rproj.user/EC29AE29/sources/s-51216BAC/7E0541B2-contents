#' Function for creating an sf point object to resemble dotting within a polygon for plotting on a map.
#' This function returns an sf point object.
#' Eventually the package {ggpattern} will render this function useless, but the functionality is not yet there.
#' @param x the sf object containing polygons that you want dotted. 
#' @param custom_bbox the option for a custom bounding box to standardise density in a repetitive mapping process. If blank, the bbox of the sf object will be used.
#' @param den the density of dots. 
#' @keywords sf, dot, mapping, symbology, ggplot
#' @export
#' @examples
#' dots <- dot(sf_df, sf_bbox)
#'

dot <- function(x, custom_bbox = NULL, den = 4000){
  library(sf)
  library(dplyr)
  if(is.null(bbox)){
    dots = st_sample(st_as_sfc(st_bbox(x)), den, type = "hexagonal") %>%
      st_sf() %>%
      #st_transform(27700) %>%
      rename("WKT" = geometry)
  }else{
  dots = st_sample(st_as_sfc(bbox), den, type = "hexagonal") %>%
    st_sf() %>%
    #st_transform(27700) %>%
    rename("WKT" = geometry)
  }
  dots = st_intersection(dots, x)
  return(dots)
}
